---
const navItems = [
  { label: "Nosotros", href: "#nosotros" },
  { label: "Servicios", href: "#servicios" },
  { label: "Equipos", href: "#equipos" },
  { label: "Política", href: "#politica-calidad" },
  { label: "Cotizar", href: "#cotizar" },
];

const phone = "+52 782 115 2175";
---

<header class="fixed inset-x-0 top-0 z-50 bg-transparent transition-all duration-300" data-header>
  <div class="mx-auto flex h-20 max-w-7xl items-center justify-between gap-6 px-6 sm:px-8 lg:px-10">
    <a href="/" class="no-underline flex items-center gap-3">
      <img
        src="/images/talam-logo-white.png"
        alt="TALAM Maquinaria y Suministros"
        width="270"
        height="78"
        loading="eager"
        decoding="async"
        fetchpriority="high"
        class="h-13.5 w-auto"
      />
    </a>

    <nav class="hidden items-center gap-6 text-sm font-semibold text-white lg:flex">
      {navItems.map((item) => (
        <a
          href={item.href}
          class="no-underline rounded-md px-3 py-2 text-white/90 transition-all duration-300 hover:bg-white/10 hover:text-white"
        >
          {item.label}
        </a>
      ))}
    </nav>

    <div class="flex items-center gap-3">
      <a
        href={`tel:${phone.replace(/\s/g, "")}`}
        class="cursor-pointer no-underline hidden items-center gap-2 rounded-md border border-white/30 bg-white/10 px-4 py-2.5 text-base font-semibold text-white shadow-sm md:flex"
        aria-label="Llamar a TALAM"
      >
        <svg viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="1.5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a1.5 1.5 0 0 0 1.5-1.5v-3.218a1.5 1.5 0 0 0-.97-1.405l-3.25-1.3a1.5 1.5 0 0 0-1.7.444l-1.3 1.585a12.042 12.042 0 0 1-5.25-5.25l1.585-1.3a1.5 1.5 0 0 0 .444-1.7l-1.3-3.25A1.5 1.5 0 0 0 7.718 3H4.5A1.5 1.5 0 0 0 3 4.5v2.25z" />
        </svg>
        {phone}
      </a>
      <a href="#cotizar" class="cursor-pointer no-underline rounded-md bg-blue-600 px-5 py-2.5 text-base font-semibold text-white shadow-sm">
        Cotizar
      </a>
      <details class="relative lg:hidden" id="mobile-menu">
        <summary class="flex h-10 w-10 cursor-pointer items-center justify-center rounded-md border border-white/30 bg-white/10 text-white" aria-label="Abrir menú">
          <svg viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.8">
            <path stroke-linecap="round" stroke-linejoin="round" d="M4 7h16M4 12h16M4 17h16" />
          </svg>
        </summary>
        <div class="absolute right-0 mt-3 w-52 rounded-md border border-slate-700/30 bg-slate-900/95 p-2 shadow-xl">
          <nav class="flex flex-col text-sm font-semibold text-white">
            {navItems.map((item) => (
              <a href={item.href} class="no-underline rounded-md px-3 py-2 text-white/90 transition-all duration-300 hover:bg-white/10 hover:text-white">
                {item.label}
              </a>
            ))}
          </nav>
        </div>
      </details>
    </div>
  </div>
</header>

<script is:inline>
  const header = document.querySelector("[data-header]");
  let lastScrollY = 0;
  let ticking = false;

  const updateHeader = () => {
    if (!header) return;
    const currentScrollY = window.scrollY;

    if (currentScrollY > 100) {
      header.classList.add("bg-slate-900", "shadow-lg", "backdrop-blur");
      header.classList.remove("bg-transparent");
    } else {
      header.classList.remove("bg-slate-900", "shadow-lg", "backdrop-blur");
    }

    if (currentScrollY > lastScrollY && currentScrollY > 80) {
      header.style.transform = "translateY(-100%)";
    } else {
      header.style.transform = "translateY(0)";
    }

    lastScrollY = currentScrollY;
    ticking = false;
  };

  const onScroll = () => {
    if (!ticking) {
      requestAnimationFrame(updateHeader);
      ticking = true;
    }
  };

  updateHeader();
  window.addEventListener("scroll", onScroll, { passive: true });

  const menu = document.getElementById("mobile-menu");
  if (menu) {
    document.addEventListener("click", (event) => {
      if (!menu.contains(event.target)) {
        menu.removeAttribute("open");
      }
    });
  }
</script>
